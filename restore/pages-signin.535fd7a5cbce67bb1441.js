"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[6785],{30722:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ez});var a,i,o,r=n(28760),s=n.n(r),c=n(28222),l=n.n(c),u=n(80222),d=n.n(u),m=n(14418),p=n.n(m),h=n(8446),f=n.n(h),g=n(66870),v=n.n(g),E=n(73126),w=n(5281),b=n(44845),_=n(68420),y=n(27344),T=n(90306),C=n(3020),S=n(3362),N=n(35627),k=n.n(N),x=n(27043),L=n.n(x),A=n(58118),Z=n.n(A),D=n(63460),F=n.n(D),V=n(37659),R=n.n(V),I=n(4864),O=n(99688),P=n(29543),j=n(17482),z=n(91030),U=n(7465),K=n(68309),M=n(73710),Y=n(73960),B=n(95266),H=n(73560),W=n(3969),$=n(30381),G=n.n($),q=n(67294),J=function(e){var t=e.twoFactorCode,n=e.setTwoFactorCode,a=e.isRecoveryCode,i=e.setIsRecoveryCode,o=e.onClick,r=e.blockedUntil,s=e.isLoading,c=(0,q.useState)(G().utc()),l=(0,B.Z)(c,2),u=l[0],d=l[1],m=G().utc(null!=r?r:0).unix()-u.unix(),p=m>0,h=a?/\w{5}.*-.*\w{5}/i.test(t):/^\s*\d{6}\s*$/.test(t)||/\w{5}.*-.*\w{5}/i.test(t);return(0,q.useEffect)(function(){var e=setInterval(function(){d(G().utc())},1e3);return function(){return clearInterval(e)}},[]),q.createElement("div",{className:"signin_2fa"},a?q.createElement(q.Fragment,null,q.createElement(z.Z,{type:"dark",className:"signin__title"},"Two-Factor Recovery"),q.createElement("form",{onSubmit:o},q.createElement("div",null,q.createElement("label",null,"Recovery code"),q.createElement(j.Z,{name:"recovery_code",type:"text",className:"signin__input recovery-codes",placeholder:"Enter recovery code",value:t,onChange:function(e){return n(e.target.value)}})),q.createElement("div",{className:"fa-actions"},q.createElement(O.ZP,{type:"white",onClick:function(){i(!1),n("")}},"Back"),q.createElement(O.ZP,{type:"submit",className:"signin__submit",disabled:s||p||!1===h},"Verify ",p?"("+m+")":null)),q.createElement("div",{className:"signin_2fa-desc"},q.createElement("img",{src:H,alt:"",className:"code-icon"}),q.createElement("p",null,"You can enter one of your recovery codes in case you lost access to your mobile device.")))):q.createElement(q.Fragment,null,q.createElement(z.Z,{type:"dark",className:"signin__title"},"Two-Factor Authentication"),q.createElement("form",{onSubmit:o},q.createElement("div",null,q.createElement("label",null,"Authentication code"),q.createElement(j.Z,{name:"number_code",type:"text",className:"signin__input",placeholder:"Enter 6-digit code",value:t,onChange:function(e){return n(e.target.value)},isSuccess:/^\s*\d{6}\s*$/.test(t)||/\w{5}.*-.*\w{5}/i.test(t),isError:t.length>0&&!(/^\s*\d{6}\s*$/.test(t)||/\w{5}.*-.*\w{5}/i.test(t))})),q.createElement(O.ZP,{type:"submit",className:"signin__submit",disabled:s||p||!1===h},"Verify ",p?"("+m+")":null),q.createElement("div",{className:"signin_2fa-desc"},q.createElement("img",{src:W,alt:"",style:{width:30,height:45}}),q.createElement("p",null,"Open the two-factor authentication app on your device to view your authentication code and verify your identity.")),q.createElement("div",{className:"signin_2fa-problems"},"Having problems?"," ",q.createElement("span",{onClick:function(){i(!0),n("")}},"Enter a two-factor recovery code")))))},Q=n(33938),X=n(30222),ee=n.n(X),et=n(97606),en=n.n(et),ea=n(24278),ei=n.n(ea),eo=n(94184),er=n.n(eo);function es(){return(es=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var ec=function(e){return q.createElement("svg",es({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,viewBox:"0 0 18 18"},e),a||(a=q.createElement("path",{d:"M9 1c2.209 0 4.21.895 5.657 2.343C16.105 4.791 17 6.791 17 9s-.896 4.209-2.343 5.657A7.979 7.979 0 0 1 9 17c-2.21 0-4.21-.895-5.657-2.343A7.975 7.975 0 0 1 1 9c0-2.21.895-4.21 2.343-5.657A7.975 7.975 0 0 1 9 1z",fill:"#FFF",stroke:"#E7E8EA",strokeWidth:2,fillRule:"evenodd"})))};function el(){return(el=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var eu=function(e){return q.createElement("svg",el({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,viewBox:"0 0 18 18"},e),i||(i=q.createElement("path",{d:"M8.439 13.01a.999.999 0 0 1-1.414 0l-2.536-2.535A1 1 0 0 1 5.903 9.06l1.829 1.829 4.364-4.364a.999.999 0 1 1 1.414 1.414L8.439 13.01zM0 9a9 9 0 1 0 18 0A9 9 0 0 0 0 9z",fill:"#7475F5",fillRule:"evenodd"})))};function ed(e){var t,n;return q.createElement("div",{className:er()("signin-account flex-row flex-space-between",{"signin-account--active":e.isActive}),onClick:e.setIsActive},q.createElement("div",{className:"signin-account__content flex-row flex-space-between"},q.createElement("span",{className:"signin-account__id"},ei()(t=e.id).call(t,0,6)+"..."+ei()(n=e.id).call(n,-6)),q.createElement("span",{className:"signin-account__records"},e.recordAmount," ",1===e.recordAmount?"record":"records")),q.createElement("div",{className:"signin-account__check"},e.isActive?q.createElement(eu,null):q.createElement(ec,null)))}var em=n(42586),ep=n(67018),eh=n(15376),ef=n(67703),eg=n(76439),ev=n(90482),eE=n(26793),ew=n(28216),eb=n(59359),e_=n(66022),ey=n(20322);function eT(e){var t,n=(0,eE.$)("common"),a=n.t,i=n.i18n,o=(0,ew.I0)(),r=function(e,t){return o((0,I.jI)(e,t))},s=(0,q.useState)([]),c=(0,B.Z)(s,2),l=c[0],u=c[1],d=(0,q.useState)(0),m=(0,B.Z)(d,2),h=m[0],f=m[1],g=(0,q.useState)(1),v=(0,B.Z)(g,2),E=v[0],w=v[1],b=(0,q.useState)(null),_=(0,B.Z)(b,2),y=_[0],T=_[1],C=(0,q.useState)(null),S=(0,B.Z)(C,2),N=S[0],x=S[1],A=(0,q.useState)(null),D=(0,B.Z)(A,2),V=D[0],R=D[1];function P(){return(P=(0,Q.Z)(ee().mark(function t(n){var o;return ee().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),e.setIsLoading(!0),t.prev=2,o=l[h],t.next=6,fetch((0,eh.e)()+"/api/seedin",{method:U.K4.post,credentials:U.K4.include,body:k()({username:o.id,password:o.id,seed:o.id,language:i.language,xpub:V,publicKey:y,chainCode:N}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){var n,i,o,s,c;t.id?(window.logEvent("signin_seed"),L()(n=e.redirectTo).call(n,"/")?L()(o=e.redirectTo).call(o,"//")?(0,eg.c4)("/portfolio"):(0,eg.c4)(e.redirectTo||"/portfolio"):Z()(i=e.redirectTo).call(i,"allnodes.com")&&(Z()(s=["check.allnodes.com","www.allnodes.com"]).call(s,new(F())(e.redirectTo).host)?window.location.href=e.redirectTo:(0,eg.c4)("/portfolio"))):t&&t.error&&Z()(c=t.error).call(c,"CAPTCHA")?r(a("common:login.error.captcha",{defaultValue:"Please retry captcha validation."})):r(a("common:login.error."+t.message))});case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),r(a("admin:error.encrypt_error",{defaultValue:"Seems like we have a problem. Please contact support."}));case 11:e.setIsLoading(!1);case 12:case"end":return t.stop()}},t,null,[[2,8]])}))).apply(this,arguments)}function j(){return(j=(0,Q.Z)(ee().mark(function t(n){return ee().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),e.setIsLoading(!0),"trezor"!==e.activeTab){t.next=7;break}return t.next=5,function(){return z.apply(this,arguments)}();case 5:t.next=9;break;case 7:return t.next=9,function(){return K.apply(this,arguments)}();case 9:e.setIsLoading(!1);case 10:case"end":return t.stop()}},t)}))).apply(this,arguments)}function z(){return(z=(0,Q.Z)(ee().mark(function e(){var t,n,i;return ee().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ep.$3({currencyId:"ethereum",currencySymbol:"ethereum",isTestnet:!1,accountIndex:0});case 3:if(!(t=e.sent).success){e.next=13;break}return R(n=ep.rn(t.payload.xpub)),T(null),x(null),e.next=11,fetch((0,eh.e)()+"/api/signin/trezor",{method:U.K4.post,credentials:U.K4.include,body:k()({xpub:n}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){if(e.accounts)e.accounts.length?(u(e.accounts),f(0),w(1)):r("You don't have any accounts registered with this Trezor wallet.");else{var t;e&&e.error&&Z()(t=e.error).call(t,"CAPTCHA")?r(a("common:login.error.captcha",{defaultValue:"Please retry captcha validation."})):r(a("common:signup.error."+e.message))}});case 11:e.next=14;break;case 13:throw new ep.VF(t.payload.code,t.payload.error);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),e.t0 instanceof ep.VF?(i=e.t0.message||ep.uv[e.t0.code]||e.t0.code,"Transport_Missing"===e.t0.code?r(a("host:error.trezor.not_connected_new",{defaultValue:"It seems like the Trezor<br />is not connected to your PC."}),ep._D):i?r(a("host:error.trezor.trezor_error",{defaultValue:"Trezor Error: {{msg}}. Please contact support if you need help.",msg:i}),ep._D):r(a("admin:error.encrypt_error",{defaultValue:"Seems like we have a problem. Please contact support."}),ep._D)):r(a("admin:error.encrypt_error",{defaultValue:"Seems like we have a problem. Please contact support."}),ep._D);case 19:case"end":return e.stop()}},e,null,[[0,16]])}))).apply(this,arguments)}function K(){return(K=(0,Q.Z)(ee().mark(function e(){var t,n,i,o,s,c,l,d;return ee().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,e_.oq)();case 3:return t=e.sent,e.next=6,t.getAddress("44'/60'/0'",!1,!0);case 6:return i=(n=e.sent).publicKey,o=n.chainCode,R(null),T(i),x(o),e.next=14,fetch((0,eh.e)()+"/api/signin/ledger",{method:U.K4.post,credentials:U.K4.include,body:k()({publicKey:i,chainCode:o}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){if(e.accounts)e.accounts.length?(u(e.accounts),f(0),w(1)):r("You don't have any accounts registered with this Ledger wallet.");else{var t;e&&e.error&&Z()(t=e.error).call(t,"CAPTCHA")?r(a("common:login.error.captcha",{defaultValue:"Please retry captcha validation."})):r(a("common:signup.error."+e.message))}});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),Z()(s=e.t0.message.toLowerCase()).call(s,"0x6faa")?r(a("host:error.ledger.hw_is_disabled",{defaultValue:"Seems like your Ledger is disabled."})):Z()(c=e.t0.message.toLowerCase()).call(c,"u2f browser support is needed")?r(a("host:error.ledger.does_not_support",{defaultValue:"Seems like your browser doesn’t support Ledger connection."})):Z()(l=e.t0.message.toUpperCase()).call(l,"DEVICE_INELIGIBLE")?r(a("host:error.ledger.not_connected_new",{defaultValue:"It seems like the Ledger<br />is not connected to your PC."})):Z()(d=e.t0.message.toLowerCase()).call(d,"denied by the user")?r(a("host:error.ledger.not_confirmed",{defaultValue:"You have to confirm all public key exports to perform scanning."})):r(e.t0.message);case 19:case"end":return e.stop()}},e,null,[[0,16]])}))).apply(this,arguments)}(0,q.useEffect)(function(){ep.pP()},[]);var M="trezor"===e.activeTab?ep.zB().isConnectAvailable:"ledger"===e.activeTab&&(0,ef.t)("ledger_nano_s").available;return!0!==M?q.createElement(em.T,{isMobileNotSupported:eb.tq,type:"signin",activeTab:e.activeTab}):l.length?q.createElement("form",{className:"signin__form flex-column flex-center",onSubmit:function(e){return P.apply(this,arguments)}},q.createElement("div",{className:"signin__connect flex-row flex-center"},q.createElement("div",{className:"signin__connect-text"},"Choose account to sign in")),q.createElement("div",{style:{marginBottom:30,width:"100%"}},en()(t=p()(l).call(l,function(e,t){return t>=(E-1)*10&&t<10*E})).call(t,function(e,t){return q.createElement(ed,{key:e.id,id:e.id,recordAmount:e.recordAmount,isActive:h===t,setIsActive:function(){return f(t)}})})),l.length>10?q.createElement("div",{className:"signin-account__pagination flex-row flex-space-between"},q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"15",viewBox:"0 0 20 15",style:E>1?{cursor:"pointer"}:{},onClick:function(){E>1&&w(E-1)}},q.createElement("path",{fill:E>1?"#7475f5":"#e7e8ea",fillRule:"nonzero",d:"M7.5,15c0.7,0,1.2-0.6,1.2-1.2c0-0.3-0.1-0.7-0.4-0.9L4.3,8.7h14.5c0.7,0,1.3-0.5,1.3-1.2s-0.5-1.3-1.2-1.3 c0,0,0,0-0.1,0H4.3l4.1-4.1c0.5-0.5,0.5-1.3,0-1.8c-0.5-0.5-1.3-0.5-1.8,0L0.5,6.5c-0.5,0.4-0.7,1.2-0.2,1.7 c0.1,0.1,0.1,0.2,0.2,0.2l6.1,6.1C6.8,14.9,7.2,15,7.5,15z"})),q.createElement("span",null,E," of ",new ev.Z(l.length).div(10).ceil().toNumber()),q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"15",viewBox:"0 0 20 15",style:E<new ev.Z(l.length).div(10).ceil().toNumber()?{cursor:"pointer"}:{},onClick:function(){E<new ev.Z(l.length).div(10).ceil().toNumber()&&w(E+1)}},q.createElement("path",{fill:E<new ev.Z(l.length).div(10).ceil().toNumber()?"#7475f5":"#e7e8ea",fillRule:"nonzero",d:"M12.484 0a1.248 1.248 0 0 0-.87 2.142l4.11 4.108H1.265a1.248 1.248 0 1 0 0 2.495h14.457l-4.109 4.107a1.247 1.247 0 1 0 1.765 1.764l6.13-6.127a1.248 1.248 0 0 0-.003-1.986L13.379.378A1.248 1.248 0 0 0 12.484 0z"}))):null,q.createElement("div",{className:"signin__buttons flex-row flex-center"},q.createElement(O.ZP,{type:"submit",className:"signin__submit",disabled:e.isLoading||!0!==M},"SIGN IN"))):q.createElement("form",{className:"signin__form flex-column flex-center",onSubmit:function(e){return j.apply(this,arguments)}},q.createElement("div",{className:"signin__connect flex-row flex-center"},q.createElement(ey.P,{isActive:!1}),q.createElement("div",{className:"signin__connect-text"},"ledger"===e.activeTab?"Connect your Ledger wallet with opened Ethereum app":"Connect your Trezor wallet with opened Ethereum app")),q.createElement("div",{className:"signin__buttons flex-row flex-center"},q.createElement(O.ZP,{type:"submit",className:"signin__submit",disabled:e.isLoading||!0!==M,style:{width:230}},"ledger"===e.activeTab?"SIGN IN WITH LEDGER":"SIGN IN WITH TREZOR")))}var eC=n(38453),eS=n(49102),eN=n(87060),ek=n(69222),ex=n(91768),eL=n(83868),eA=n.n(eL),eZ=n(46702),eD=n.n(eZ);function eF(e,t){var n=l()(e);if(d()){var a=d()(e);t&&(a=p()(a).call(a,function(t){return f()(e,t).enumerable})),n.push.apply(n,a)}return n}function eV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eF(Object(n),!0).forEach(function(t){(0,b.Z)(e,t,n[t])}):v()?Object.defineProperties(e,v()(n)):eF(Object(n)).forEach(function(t){Object.defineProperty(e,t,f()(n,t))})}return e}function eR(e){var t=eI();return function(){var n,a=(0,S.Z)(e);if(t){var i=(0,S.Z)(this).constructor;n=s()(a,arguments,i)}else n=a.apply(this,arguments);return(0,C.Z)(this,n)}}function eI(){if("undefined"==typeof Reflect||!s()||s().sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(s()(Boolean,[],function(){})),!0}catch(e){return!1}}var eO=function(e){(0,T.Z)(n,e);var t=eR(n);function n(){return(0,_.Z)(this,n),t.apply(this,arguments)}return(0,y.Z)(n,[{key:"render",value:function(){return q.createElement("div",{className:"default_wrapper"},q.createElement(ej,{cookies:this.props.cookies}))}}]),n}(q.Component),eP=(0,ew.$j)(function(e){return{seedProceedToSsignIn:e.main.seedProceedToSsignIn,seed:e.signUp.seed,tokenCaptch:e.signUp.token,clientRender:e.main.clientRender,profile:e.profile,isMobile:!1,userLocation:e.sanctions.location}},function(e){return{adminNotificationFailShow:function(t){return e((0,I.jI)(t))},changeseedProceedToSsignIn:function(t){return e((0,Y.LP)(t))},setCaptchaToken:function(t){var n=t.token;return e(eC.D2({token:n}))}}})(o=function(e){(0,T.Z)(n,e);var t=eR(n);function n(e){var a;return(0,_.Z)(this,n),a=t.call(this,e),(0,b.Z)((0,w.Z)(a),"handleVerify",function(e){a.setState({token:e})}),(0,b.Z)((0,w.Z)(a),"toggleSubmit",function(e){a.state.seed.value?a.handleSeedSubmit(e):a.handleSubmit(e)}),(0,b.Z)((0,w.Z)(a),"handleSeedSubmit",function(e){e.preventDefault();var t=a.props.t,n=a.state.seed;a.setState({isLoading:!0}),fetch((0,eh.e)()+"/api/seedin",{method:U.K4.post,credentials:U.K4.include,body:k()({username:n.value,password:n.value,seed:n.value,token:a.props.tokenCaptch?a.props.tokenCaptch:a.state.token,language:a.props.i18n.language,code:a.state.twoFactorCode,isRecoveryCode:a.state.isRecoveryCode||11===a.state.twoFactorCode.length}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){if(a.setState({isLoading:!1}),"NOT_ALLOWED"===e.message)return a.props.adminNotificationFailShow("Such login option is not allowed for this account.");if("2FA_NEEDED"===e.message)return a.setState({isTwoFactorStep:!0});if(null!==(n=e.message)&&void 0!==n&&L()(n).call(n,"BLOCKED_UNTIL_"))return a.props.adminNotificationFailShow("You have tried too often. Please wait a minute before trying again."),a.setState({blockedUntil:e.message.split("BLOCKED_UNTIL_")[1]});if(null!==(i=e.message)&&void 0!==i&&L()(i).call(i,"RECOVERY_CODE_ALREADY_REDEEMED_")){var n,i,o,r,s,c,l,u=e.message.split("RECOVERY_CODE_ALREADY_REDEEMED_")[1];return a.props.adminNotificationFailShow("This code was redeemed "+(0,eS.F)(G().utc(u).valueOf(),a.props.t)+".")}return"TOKEN_ALREADY_USED"===e.message?a.props.adminNotificationFailShow("You have tried too often. Please wait a minute before trying again."):"INVALID_CODE"===e.message?a.props.adminNotificationFailShow(a.state.isRecoveryCode||11===a.state.twoFactorCode.length?"This recovery code is incorrect.":"This 2fa code is incorrect."):void(e.id?(window.logEvent("signin_seed"),a.props.setCaptchaToken({token:null}),L()(o=a.state.redirectTo).call(o,"/")?L()(s=a.state.redirectTo).call(s,"//")?(0,eg.c4)("/portfolio"):(0,eg.c4)(a.state.redirectTo||"/portfolio"):Z()(r=a.state.redirectTo).call(r,"allnodes.com")&&(Z()(c=["check.allnodes.com","www.allnodes.com"]).call(c,new(F())(a.state.redirectTo).host)?window.location.href=a.state.redirectTo:(0,eg.c4)("/portfolio"))):(e&&e.error&&Z()(l=e.error).call(l,"CAPTCHA")?a.props.adminNotificationFailShow(t("common:login.error.captcha",{defaultValue:"Please retry captcha validation."})):a.props.adminNotificationFailShow(t("common:login.error."+e.message)),a.setState({password:{value:"",isTouched:!1,isValid:!1},submit:{isDisabled:!0}})))}).catch(function(){a.setState({isLoading:!1})})}),(0,b.Z)((0,w.Z)(a),"handleSubmit",function(e){e.preventDefault();var t=a.props.t,n=a.state,i=n.username,o=n.passwordSave;a.setState({isLoading:!0}),fetch((0,eh.e)()+"/api/signin",{method:U.K4.post,credentials:U.K4.include,body:k()({username:i.value,password:o,token:a.state.token,language:a.props.i18n.language,code:a.state.twoFactorCode,isRecoveryCode:a.state.isRecoveryCode||11===a.state.twoFactorCode.length}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){if(a.setState({isLoading:!1}),"2FA_NEEDED"===e.message)return a.setState({isTwoFactorStep:!0});if(null!==(n=e.message)&&void 0!==n&&L()(n).call(n,"BLOCKED_UNTIL_"))return a.props.adminNotificationFailShow("You have tried too often. Please wait a minute before trying again."),a.setState({blockedUntil:e.message.split("BLOCKED_UNTIL_")[1]});if(null!==(i=e.message)&&void 0!==i&&L()(i).call(i,"RECOVERY_CODE_ALREADY_REDEEMED_")){var n,i,o,r,s,c,l=e.message.split("RECOVERY_CODE_ALREADY_REDEEMED_")[1];return a.props.adminNotificationFailShow("This code was redeemed "+(0,eS.F)(G().utc(l).valueOf(),a.props.t)+".")}return"TOKEN_ALREADY_USED"===e.message?a.props.adminNotificationFailShow("Please wait for next 2fa code."):"INVALID_CODE"===e.message?a.props.adminNotificationFailShow(a.state.isRecoveryCode||11===a.state.twoFactorCode.length?"This recovery code is incorrect.":"This 2fa code is incorrect."):void(e.id?(window.logEvent("signin_submit"),L()(o=a.state.redirectTo).call(o,"/")?L()(s=a.state.redirectTo).call(s,"//")?(0,eg.c4)("/portfolio"):(0,eg.c4)(a.state.redirectTo||"/portfolio"):Z()(r=a.state.redirectTo).call(r,"allnodes.com")&&(Z()(c=["check.allnodes.com","www.allnodes.com"]).call(c,new(F())(a.state.redirectTo).host)?window.location.href=a.state.redirectTo:(0,eg.c4)("/portfolio"))):(a.props.adminNotificationFailShow(t("common:login.error."+e.message)),a.setState({password:{value:"",isTouched:!1,isValid:!1},submit:{isDisabled:!0}})))}).catch(function(){a.setState({isLoading:!1})})}),(0,b.Z)((0,w.Z)(a),"handleChangeSeed",function(e){var t=e.target.value.length>20;0===e.target.value.length.length&&a.props.setCaptchaToken({token:null}),a.setState({seed:{value:e.target.value,isTouched:!0,isValid:t}})}),(0,b.Z)((0,w.Z)(a),"handleChangeUsername",function(e){var t=eA()(e.target.value)||"nem@gmail.com"===e.target.value,n={username:{value:e.target.value,isTouched:!0,isValid:t}};a.validateForm(eV(eV({},a.state),n)),a.setState(n)}),(0,b.Z)((0,w.Z)(a),"handleChangePassword",function(e){a.setState({passwordSave:e.target.value});var t=e.target.value.length>7,n={password:{value:e.target.value,isTouched:!0,isValid:t}};a.validateForm(eV(eV({},a.state),n)),a.setState(n)}),a.state={username:{value:"",isTouched:!1,isValid:!1},password:{value:"",isTouched:!1,isValid:!1},passwordSave:"",submit:{isDisabled:!0},isLoading:!1,seed:{value:e.seed||"",isTouched:!1,isValid:!1},activeTab:"email",redirectTo:"/portfolio",token:null,twoFactorCode:"",isRecoveryCode:!1,isTwoFactorStep:!1,blockedUntil:null},a}return(0,y.Z)(n,[{key:"render",value:function(){var e=this;return q.createElement("main",{className:"signin flex-column flex-center"},q.createElement(K.Z,null,q.createElement(M.Z,{isWhite:!1})),this.state.isTwoFactorStep?q.createElement("div",{className:"signin__content flex-column flex-center"},q.createElement(J,{twoFactorCode:this.state.twoFactorCode,setTwoFactorCode:function(t){return e.setState({twoFactorCode:t})},isRecoveryCode:this.state.isRecoveryCode,setIsRecoveryCode:function(t){return e.setState({isRecoveryCode:t})},onClick:this.toggleSubmit,blockedUntil:this.state.blockedUntil,isLoading:this.state.isLoading})):q.createElement("div",{className:"signin__content flex-column flex-center"},q.createElement(z.Z,{type:"dark",className:"signin__title"},this.props.t("common:login.title")),this.renderTabs(),this.triggerForm()))}},{key:"componentDidMount",value:function(){window.logEvent("signin_show");var e="email",t=null,n=null,a="/portfolio",i=new(R())(this.props.location.search);if(i.has("type")){var o=i.get("type");"trezor"===o||"ledger"===o?!0!==this.props.isMobile&&(t=o):("email"===o||"seed"===o)&&(t=o)}if(this.props.cookies.get("AUTH_METHOD")){var r=this.props.cookies.get("AUTH_METHOD");"trezor"===r||"ledger"===r?!0!==this.props.isMobile&&(n=r):("email"===r||"seed"===r)&&(n=r)}e=t||n||e,i.has("redirectTo")&&(a=i.get("redirectTo")),this.setState({activeTab:e,redirectTo:a})}},{key:"validateForm",value:function(e){this.setState({submit:{isDisabled:!(e.username.isValid&&e.password.isValid)}})}},{key:"triggerForm",value:function(){var e=this;return"email"===this.state.activeTab?this.renderSigninEmail():"seed"===this.state.activeTab?this.renderSigninSeed():"ledger"===this.state.activeTab||"trezor"===this.state.activeTab?q.createElement(eT,{activeTab:this.state.activeTab,isLoading:this.state.isLoading,setIsLoading:function(t){return e.setState({isLoading:t})},redirectTo:this.state.redirectTo}):null}},{key:"renderSigninEmail",value:function(){var e=this.state,t=e.username,n=e.password,a=e.submit,i=e.isLoading,o="CN"===this.props.userLocation;return q.createElement("form",{className:"signin__form flex-column flex-center",onSubmit:this.handleSubmit},q.createElement(j.Z,{name:"username",className:"signin__input",placeholder:this.props.t("common:login.username"),value:t.value,onChange:this.handleChangeUsername,isSuccess:t.isTouched&&t.isValid,isError:t.isTouched&&!t.isValid,isErrorText:this.props.t("common:signup.error.email")}),q.createElement(j.Z,{name:"password",type:"password",className:"signin__input",placeholder:this.props.t("common:login.password"),value:n.value,onChange:this.handleChangePassword,isSuccess:n.isTouched&&n.isValid,isError:n.isTouched&&!n.isValid,isErrorText:this.props.t("common:signup.error.password")}),o?null:this.state.isLoading?null:q.createElement("div",{style:{marginTop:10,marginLeft:"auto",marginRight:"auto"}},q.createElement(eD(),{sitekey:"f90a1eb0-8cbb-4de3-9e9e-96557a5c7728",onVerify:this.handleVerify})),q.createElement("div",{className:"signin__buttons flex-row flex-space-between"},q.createElement(P.h,{className:"signin__forgot",to:"/restore"},this.props.t("common:login.forgot")),q.createElement(O.ZP,{type:"submit",className:"signin__submit",disabled:a.isDisabled||i||null==this.state.token&&!o},this.props.t("common:login.submit"))))}},{key:"renderSigninSeed",value:function(){var e=this.state,t=e.seed,n=e.isLoading,a="CN"===this.props.userLocation;return q.createElement("form",{className:"signin__form flex-column flex-center",onSubmit:this.handleSeedSubmit},q.createElement(j.Z,{name:"seed",type:"text",className:"signin__input",placeholder:"Seed",value:t.value,onChange:this.handleChangeSeed,isSuccess:t.isTouched&&t.isValid,isError:t.isTouched&&!t.isValid,isErrorText:this.props.t("common:signup.error.seed")}),a?null:this.state.isLoading||this.props.tokenCaptch?null:q.createElement("div",{style:{marginTop:10,marginLeft:"auto",marginRight:"auto"}},q.createElement(eD(),{sitekey:"f90a1eb0-8cbb-4de3-9e9e-96557a5c7728",onVerify:this.handleVerify})),q.createElement("div",{className:"signin__buttons flex-row flex-end"},q.createElement(O.ZP,{type:"submit",className:"signin__submit",disabled:t.isTouched&&!t.isValid||n||null==this.state.token&&!a&&!this.props.tokenCaptch},this.props.t("common:signup.use_seed",{defaultValue:"Use Seed"}))))}},{key:"renderTabs",value:function(){var e=this;return q.createElement("div",{className:er()("signin__tabs flex-row",{"signin__tabs--mobile":this.props.isMobile})},q.createElement("div",{onClick:function(){return e.setActiveTab("email")},className:er()("signin__tab",{active:"email"===this.state.activeTab})},this.props.t("common:login.tabs.email")),q.createElement("div",{onClick:function(){return e.setActiveTab("seed")},className:er()("signin__tab",{active:"seed"===this.state.activeTab})},this.props.t("common:login.tabs.seed")),!0!==this.props.isMobile?q.createElement("div",{onClick:function(){return e.setActiveTab("ledger")},className:er()("signin__tab",{active:"ledger"===this.state.activeTab})},"Ledger"):null,!0!==this.props.isMobile?q.createElement("div",{onClick:function(){return e.setActiveTab("trezor")},className:er()("signin__tab",{active:"trezor"===this.state.activeTab})},"Trezor"):null)}},{key:"setActiveTab",value:function(e){!0!==this.state.isLoading&&((0,eg.c4)("/signin?type="+e+("/portfolio"!=this.state.redirectTo?"&redirectTo="+this.state.redirectTo:"")),this.setState({activeTab:e}))}}]),n}(q.Component))||o;function ej(e){return q.createElement(eg.Ye,null,function(t){var n=t.location;return q.createElement(ek.W,{ns:"common"},function(t,a){var i=a.i18n;return q.createElement(eP,(0,E.Z)({t:t,i18n:i,location:n},e))})})}let ez=(0,eN.Z)((0,ex.Z)("common")(eO))}}]);